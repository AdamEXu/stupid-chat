<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Generate T3 Chat Ripoff</title>
        <style>
            body {
                margin: 40px auto;
                max-width: 650px;
                line-height: 1.6;
                font-size: 18px;
                color: #444;
                padding: 0 10px;
            }
            h1,
            h2,
            h3 {
                line-height: 1.2;
            }

            .chat {
                position: absolute;
                width: 100vw;
                height: 100vh;
                margin: 0;
                padding: 0;
                left: 0;
                top: 0;
            }

            #chat-frame {
                width: 100vw;
                height: 100vh;
                margin: 0;
                padding: 0;
                border: none;
                outline: none;
                box-shadow: none;
            }

            evensmaller {
                font-size: 4px;
            }
        </style>
    </head>
    <body>
        <div class="chat" style="display: none">
            <iframe src="" id="chat-frame"></iframe>
        </div>
        {% if not user %}
        <div>
            <p>
                <a href="/login"><button>LOGIN</button></a>
            </p>
            <small
                >Note: There is absolutely no reason to login. But if you want
                to...</small
            >
        </div>
        {% endif %} {% if user %}
        <div>
            <p>Greetings, {{first}}</p>
            <h2>Hop back into your T3 Chat clones!</h2>
            <ul>
                {% for clone in clones %}
                <li>
                    <a href="/?cur={{clone.id}}"
                        >Click here to access clone id {{clone.id}}!</a
                    >
                </li>
                {% endfor %}
            </ul>
            {% if clones|length == 0 %}
            <p>
                You haven't generated any T3 Chat clones yet! Click the button
                below to start generating!
            </p>
            {% endif %}
            <small>To logout, clear all browser data.</small><br />
            <evensmaller>or click <a href="/logout">here</a></evensmaller>
        </div>
        {% endif %}
        <h1>Generate T3 Chat Ripoff</h1>
        <p>Adam Xu â€¢ June 17, 2025 â€¢ 5 minute read</p>
        <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" target="_blank">
            <img
                src="https://i.ibb.co/tnB5mvq/Cleanshot-2025-06-17-at-10-54-41-2x.png"
            />
        </a>
        <small>T3 Chat Day 1 vs Day 100 ðŸ˜±</small>
        <p>With a single button click, you can generate a T3 chat ripoff!</p>
        <p>
            Tired of using a good chat app? Have AI generate an AI chat app for
            you on the fly!
        </p>
        <p>
            You'll have a <i>unique</i> AI chat experience with a subpar UX, but
            who cares, because it's AI!
        </p>
        <p>
            Once you've generated a chat experience, you'll be able to copy the
            URL to save your favorite stupid chat user interfaces!
        </p>
        <button onclick="generateChatApp()" id="skibidi">
            Generate your very own chat app with a simple click of a button!
            Just click on this button, and you'll experience a chat experience
            where you can talk to an AI. Why am I putting so much text into this
            button? To piss Theo off obviously.
            <img
                src="https://sc.mogicons.com/l/troll-face-22.png"
                height="20"
            />
        </button>
        <small
            >btw in case you couldn't figure it out the button above generates a
            t3 chat ripoff</small
        >
        <p>
            If you want to really make a personalized chat app (that still sucks
            but it's <i>personal</i>) type a theme or something idrc and the ai
            will generate something like that
        </p>
        <input
            type="text"
            id="theme-input"
            placeholder="Type something in here"
            value="T3 Chat Ripoff"
            style="width: 100%"
        />
        <h2>FAQ</h2>
        <p><b>Who's paying for inference?</b></p>
        <p>
            You! You'll need to use your own OpenRouter API key once a chat
            interface has been generated. The OpenRouter API key will be used
            directly on your client to call the OpenRouter API, as every good
            chat app will obviously do. However, I'm the one paying for
            inference when you're generating chat apps...
        </p>
        <p><b>Is this better than T3 Chat?</b></p>
        <p>
            Yes. T3 Chat has fancy useless features like a good user experience,
            image generation, file uploads, conversation history, and other
            frivelous features that you don't need. This chat app generates chat
            apps. There's even a text box where you can specify what features or
            theme you want!
        </p>
        <p><b>Why?</b></p>
        <p>Yes.</p>
        <p><b>How to view previous websites I've generated?</b></p>
        <p>
            Create an account by clicking the useless login button at the top of
            the page! Despite the caption, it does actually save threads under
            your account.
        </p>
        <p><b>Why do I have to enter my OpenRouter API key each time?</b></p>
        <p>Was too lazy to implement global saving lmao</p>
        <h2>Notes</h2>
        <p>
            Yes, this is satire. No one should genuinely use this. Unless you're
            a psycopath.
        </p>
        <p>
            BTW pls don't spam the button I'm paying for the inference to
            generate the actual chat ui and that does take quite a few tokens
            and i dont want to go bankrupt this is modern art
        </p>
        <a href="https://github.com/adamexu/stupid-chat"
            >Open source on GitHub! Yes, this link is the default color. womp
            womp theo (I would change it but i really want to piss you off)</a
        >
        <small
            >btw the code is bad but i made this in like 1 hour so pls dont
            judge too harsh :(</small
        >
        <p>
            Styling inspired by
            <a href="https://bettermotherfuckingwebsite.com/" target="_blank"
                >bettermotherfuckingwebsite.com</a
            >
        </p>
    </body>
    <script>
        // Check if there's a cur parameter in the URL on page load
        window.addEventListener("DOMContentLoaded", function () {
            const urlParams = new URLSearchParams(window.location.search);
            const cur = urlParams.get("cur");

            if (cur) {
                loadChatApp(cur);
            }
        });

        function generateChatApp() {
            // Change button text to indicate loading with character counter
            const button = document.getElementById("skibidi");
            button.innerHTML =
                "Starting generation... (0 characters generated)... this will take about a minute, please be patient smh, its typically about 40,000 characters btw";
            button.disabled = true;

            // Get theme value from input
            const themeInput = document.getElementById("theme-input");
            const theme = themeInput ? themeInput.value.trim() : "";

            // Build URL with theme parameter if provided
            let url = "/generate-chat-app-stream";
            if (theme) {
                url += `?theme=${encodeURIComponent(theme)}`;
            }

            // Use EventSource for streaming
            const eventSource = new EventSource(url);
            let charCount = 0;

            eventSource.onmessage = function (event) {
                try {
                    const data = JSON.parse(event.data);

                    switch (data.type) {
                        case "start":
                            button.innerText = `${data.message} (${data.char_count} characters generated)... this will take about a minute, please be patient smh, its typically about 40,000 characters btw`;
                            break;

                        case "progress":
                            charCount = data.char_count;
                            button.innerText = `Generating your chat app... (${charCount} characters generated)... this will take about a minute, please be patient smh, its typically about 40,000 characters btw`;
                            break;

                        case "complete":
                            eventSource.close();

                            if (data.html && data.id) {
                                showChatApp(data.html);
                                // Update URL to include the new ID
                                window.history.pushState(
                                    {},
                                    "",
                                    `/?cur=${data.id}`
                                );
                            }

                            // Reset button after a short delay
                            setTimeout(() => {
                                button.innerHTML =
                                    'Generate your very own chat app with a simple click of a button! Just click on this button, and you\'ll experience a chat experience where you can talk to an AI. Why am I putting so much text into this button? To piss Theo off obviously. <img src="https://sc.mogicons.com/l/troll-face-22.png" height="20" />';
                                button.disabled = false;
                            }, 2000);
                            break;

                        case "error":
                            eventSource.close();
                            button.innerHTML =
                                "womp womp generation failed click me again!";
                            button.disabled = false;
                            alert(`Error: ${data.message}`);
                            break;
                    }
                } catch (e) {
                    console.error("Error parsing streaming data:", e);
                }
            };

            eventSource.onerror = function (event) {
                console.error("EventSource error:", event);
                eventSource.close();
                button.innerHTML = "Generation failed - click to try again";
                button.disabled = false;
                alert(
                    "the chat app exploded and didn't work, please refresh and try again. this is most likely because the server i was hosting it on exploded or i ran out of money to pay openai bills"
                );
            };
        }

        function loadChatApp(id) {
            // Use streaming endpoint for consistency, but existing apps load immediately
            const eventSource = new EventSource(
                `/generate-chat-app-stream?cur=${id}`
            );

            eventSource.onmessage = function (event) {
                try {
                    const data = JSON.parse(event.data);

                    switch (data.type) {
                        case "complete":
                            eventSource.close();
                            if (data.html && data.id) {
                                showChatApp(data.html);
                            }
                            break;

                        case "error":
                            eventSource.close();
                            alert(`Error loading app ${id}: ${data.message}`);
                            break;
                    }
                } catch (e) {
                    console.error("Error parsing streaming data:", e);
                }
            };

            eventSource.onerror = function (event) {
                console.error("EventSource error:", event);
                eventSource.close();
                alert(`Failed to load chat app ${id}. Please try again.`);
            };
        }

        function showChatApp(html) {
            // Hide the homepage content
            document.body.children[1].style.display = "none"; // Hide everything except the chat div
            for (let i = 2; i < document.body.children.length; i++) {
                document.body.children[i].style.display = "none";
            }

            // Show the chat iframe
            const chatDiv = document.querySelector(".chat");
            const iframe = document.getElementById("chat-frame");

            // Create a blob URL for the HTML content
            const blob = new Blob([html], { type: "text/html" });
            const url = URL.createObjectURL(blob);

            iframe.src = url;
            chatDiv.style.display = "block";
        }
    </script>
</html>
